---
title: "a3_task3_shayan_kaveh"
author: "Shayan Kaveh"
date: "10/23/2021"
output: html_document
---

## Overview

This code explores data on red and purple sea urchins recorded by Santa Barbara Coastal Long Term Ecological Research program divers.

**Data:** Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. <https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b>.

## Set Up
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(kableExtra)
```

## Read in data
```{r}
urchins <- read_csv(here("data", "urchins.csv")) %>% 
  clean_names()
```

## Section 1
1. Data visualization: compare the distribution of sizes of purple and red urchins with a histogram

```{r}
ggplot(data = urchins, 
         aes(x = size)) + 
  geom_histogram(bins = 12, 
                 aes(fill = common_name)) +
  theme_minimal() +
  scale_fill_manual(values = c("mediumpurple1", "indianred1")) + #scale_fill_manual() allows me to assign specific colors to each facet based on the vector
  facet_wrap(~ common_name) +
  labs(title = "Distribution of Purple and Red Urchin Sizes",
       key = "Common Name",
       x = "Size (cm)",
       y = "Count",
       caption = "Fig 1. Distribution of urchin sizes based on color from Santa Barbara Coastal Long Term Ecological Research",
       fill = "Common Name") + # "fill" edits the caption name
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        plot.caption = element_text(hjust = 0.05))
```

2. Descriptive Statistics Table: Create a finalized summary table that contains the following statistics for purple and red urchins (still ignoring site as a variable, but including species as a grouping variable): mean, median, standard deviation, and sample size. Use kableExtra (or another package for tables in R) to finalize your table for your knitted document. Add a table caption above your table

```{r}
urchin_summary <- urchins %>% 
  group_by(common_name) %>% 
  summarize(mean_size = mean(size, na.rm = TRUE),
            median_size = median(size, na.rm = TRUE),
            sd_size = sd(size, na.rm = TRUE),
            sample_size = n())

# Create a table to present the data using kableExtra()
urchin_summary %>% 
  kable(digits = c(2, 2, 2, 2),
        col.names = c("Common Name",
                      "Mean Size (cm)",
                      "Median Size (cm)",
                      "Standard Deviation (cm)",
                      "Sample Size"),
        caption = "<center><bold>Table 1. Summary of Statistics of Purple and Red Urchins<center><bold>") %>% 
  kable_styling(full_width = FALSE) 
```

